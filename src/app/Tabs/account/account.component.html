<ion-content class="no-scroll">
  <!-- Profile Picture Container -->
  <div style="position: relative; width: 100px; height: 100px; margin: auto">
    <img
      *ngIf="user?.profilePicture"
      [src]="user.profilePicture"
      alt="Profile Picture"
      style="width: 100%; margin-top: 5px; height: 100%; border-radius: 50%; object-fit: cover"
    />
    <!-- Move the + icon to the top, open preview window on click -->
    <div
      style="
        position: absolute;
        top: 5px;
        right: 0;
        border-radius: 50%;
        width: 100px;
        height: 100px;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 2px solid #ccc;
        cursor: pointer;
      "
      (click)="openImagePreview()"
    >
      <ion-icon name="add-outline" size="small"></ion-icon>
    </div>
  </div>

 <!-- Image Preview and Edit Modal (hidden by default) -->
<div *ngIf="isPreviewVisible" class="image-preview-modal">
  <div class="image-preview-container">
    <img [src]="previewImage" alt="Preview" class="circle-crop-preview" />
    <div style="margin-top: 15px; display: flex; justify-content: space-between;">
      <ion-button color="primary" (click)="saveProfilePicture()">Save</ion-button>
      <ion-button color="danger" (click)="deleteProfilePicture()">Delete</ion-button>
      <ion-button color="medium" (click)="isPreviewVisible = false" style="position: absolute; top: 5px; right: 5px;">X</ion-button>
    </div>
  </div>
</div>


  <!-- Profile Edit and Details Section -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>User Details</ion-card-title>
    </ion-card-header>
    <ion-card-content *ngIf="!isEditing">
      <p><strong>Name:</strong> {{ user?.name }}</p>
      <p><strong>Email:</strong> {{ user?.email }}</p>
      <ion-button expand="block" (click)="enableEditing()">Edit Profile</ion-button>
    </ion-card-content>

    <ion-card-content *ngIf="isEditing">
      <ion-item>
        <ion-label position="stacked">Name</ion-label>
        <ion-input [(ngModel)]="updatedName"></ion-input>
      </ion-item>
      <ion-button expand="block" (click)="updateProfile()">Update</ion-button>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-card-title>Actions</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <div style="display: flex; gap: 10px">
        <ion-button expand="block" style="flex: 1">Orders</ion-button>
        <ion-button expand="block" style="flex: 1">Wishlist</ion-button>
      </div>
      <div style="display: flex; gap: 10px; margin-top: 10px">
        <ion-button expand="block" style="flex: 1">Coupons</ion-button>
        <ion-button expand="block" style="flex: 1">Help Center</ion-button>
      </div>
    </ion-card-content>
  </ion-card>

  <ion-button color="danger" (click)="logout()">Log Out</ion-button>
</ion-content>

<footer>
  <app-menu-tabs></app-menu-tabs>
</footer>
